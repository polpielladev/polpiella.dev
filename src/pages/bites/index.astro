---
import BaseLayout from "@layouts/BaseLayout.astro";
import WeeBiteCategory from "@components/WeeBiteCategory.astro";
import { getCollection } from "astro:content";

const allPosts = await getCollection("bites");

const categoriesMap = Object.freeze({
    "unit-testing": {
        emoji: "ðŸ§ª",
        name: "Unit Testing",
        background: "bg-green-400/30",
        hoverColor: "bg-green-400/50",
        emojiBackground: "bg-green-600/30",
    },
    swiftui: {
        emoji: "ðŸ‘¨â€ðŸŽ¨",
        name: "SwiftUI",
        background: "bg-gray-400/30",
        hoverColor: "bg-gray-400/90",
        emojiBackground: "bg-gray-600/30",
    },
    "xcode-cloud": {
        emoji: "ðŸŒ©",
        name: "Xcode Cloud",
        background: "bg-blue-400/30",
        hoverColor: "bg-blue-400/90",
        emojiBackground: "bg-blue-600/30",
    },
    swift: {
        emoji: "ðŸ¦",
        name: "Swift",
        background: "bg-orange-400/30",
        hoverColor: "bg-orange-400/90",
        emojiBackground: "bg-orange-600/30",
    },
    "github-actions": {
        emoji: "ðŸ¤–",
        name: "GitHub Actions",
        background: "bg-lime-400/30",
        hoverColor: "bg-lime-400/90",
        emojiBackground: "bg-lime-600/30",
    },
    "core-data": {
        emoji: "ðŸ’¾",
        name: "Core Data",
        background: "bg-purple-400/30",
        hoverColor: "bg-purple-400/90",
        emojiBackground: "bg-purple-600/30",
    },
    "app-store-connect-api": {
        emoji: "ðŸ”—",
        name: "App Store Connect API",
        background: "bg-cyan-400/30",
        hoverColor: "bg-cyan-400/90",
        emojiBackground: "bg-cyan-600/30",
    },
    cli: {
        emoji: "ðŸ–¥",
        name: "Command Line",
        background: "bg-fuchsia-400/30",
        hoverColor: "bg-fuchsia-400/90",
        emojiBackground: "bg-fuchsia-600/30",
    },
    musickit: {
        emoji: "ðŸŽ¸",
        name: "MusicKit",
        background: "bg-pink-400/30",
        hoverColor: "bg-pink-400/90",
        emojiBackground: "bg-pink-600/30",
    },
    "swift-package-manager": {
        emoji: "ðŸ“¦",
        name: "Swift Package Manager",
        background: "bg-amber-400/30",
        hoverColor: "bg-amber-400/90",
        emojiBackground: "bg-amber-600/30",
    },
});

const categories = allPosts.reduce((acc, post) => {
    const { category } = post.data;
    if (!acc.includes(category)) {
        acc.push(category);
    }
    return acc;
}, []);
---

<BaseLayout
    title="All articles â€” polpiella.dev"
    description="All articles about iOS development and Swift in my blog"
    activeNav="posts"
>
    <article class="flex flex-col gap-8 max-w-2xl mx-auto">
        <header class="text-center flex flex-col gap-4 items-center">
            <img
                width="208px"
                height="208px"
                class="w-52 aspect-square m-0"
                src="/assets/wee-bites.svg"
            />
            <h1
                class="text-4xl font-title tracking-tight leading-none text-gray-900 md:text-5xl lg:text-6xl dark:text-white"
            >
                Wee Bites
            </h1>
            <p
                class="text-lg font-normal text-gray-500 lg:text-xl dark:text-gray-400"
            >
                A collection of code snippets and short-form articles about
                Apple development and Swift.
            </p>
        </header>
        <div class="grid grid-cols-2 gap-3">
            {
                categories.map((category) => {
                    const {
                        emoji,
                        background,
                        hoverColor,
                        emojiBackground,
                        name,
                    } = categoriesMap[category];
                    return (
                        <WeeBiteCategory
                            href=`/bites/${category}`
                            title={name}
                            emoji={emoji}
                            background={background}
                            hoverColor={hoverColor}
                            emojiBackground={emojiBackground}
                        />
                    );
                })
            }
        </div>
    </article>
</BaseLayout>
